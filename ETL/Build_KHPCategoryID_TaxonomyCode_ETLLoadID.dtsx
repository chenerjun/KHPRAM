<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/4/2015 9:01:46 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="T530"
  DTS:CreatorName="T530\William"
  DTS:DTSID="{FBC8298D-F398-44E6-8347-AA4FEE9AEA28}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="12.0.4100.1"
  DTS:LocaleID="1033"
  DTS:ObjectName="Build_KHPCategoryID_TaxonomyCode_ETLLoadID"
  DTS:PackageType="5"
  DTS:VersionBuild="5"
  DTS:VersionGUID="{6C081859-4694-482B-94B5-4F39290F16C9}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\SQL_Create_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2A0AF301-B360-4CA7-A4D0-742B66436D62}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="SQL_Create_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{0F6BD84F-BD54-48DE-8201-666D91840F53}"
          SQLTask:SqlStatementSource="insert into [dbo].[KHPETLLoadID_InterestTaxonomyCode_CategoryID] (ETLLoadID, [KHPInterestTaxonomyCode],[KHPCategoryID])&#xA;select ac.*, kct.[CategoryID]  from (select p.ETLLoadID, ltrim(rtrim(f.TaxonomyCode)) as TaxonomyCode   &#xA;from ProgramRAW as p outer apply  [dbo].[F_taxonomyCode](p.etlloadid) as f ) as ac &#xA;join [dbo].[KHPCategoryID_KHPInterestTaxonomyCode] as kct &#xA;&#x9;on ac.TaxonomyCode = kct.[KHPInterestTaxonomyCode]&#xA;&#x9;where kct.[Active] = 1" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\SQL_Truncate_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6D51EE20-6823-461B-8E72-64A6ADAB0227}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="SQL_Truncate_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{0F6BD84F-BD54-48DE-8201-666D91840F53}"
          SQLTask:SqlStatementSource="Truncate Table KHPETLLoadID_InterestTaxonomyCode_CategoryID" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{C3D69745-44B1-4D8B-AB8F-60E79D50D202}"
      DTS:From="Package\SQL_Truncate_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\SQL_Create_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql12">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="417,42"
          Id="Package\SQL_Create_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
          TopLeft="114,170" />
        <NodeLayout
          Size="428,42"
          Id="Package\SQL_Truncate_Table_KHPETLLoadID_InterestTaxonomyCode_CategoryID"
          TopLeft="119,58" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="333,100">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="-10.5,70"
              Start="0,0"
              End="-10.5,62.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31"
                    Point2="0,35"
                    Point3="-4,35" />
                  <mssgle:LineSegment
                    End="-6.5,35" />
                  <mssgle:CubicBezierSegment
                    Point1="-6.5,35"
                    Point2="-10.5,35"
                    Point3="-10.5,39" />
                  <mssgle:LineSegment
                    End="-10.5,62.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Accounting to Table ProgramRAW, create table KHPETLLoadID_InterestTaxonomyCode_CategoryID&#xA;in this table, &#xA;1) pivot column TaxonomyCodes&#xA;2) mapping KHP Category&#xD;&#xA;3) when TaxonomyCode is active&#xD;&#xA;&#xA;so it looks like: ETLLoadID -- KHPInterest Taxonomy Code -- KHP Category ID&#xA;&#xA;here, one rescore(record) has multiple TaxonomyCode, ,but not all of Taxonomycode, KHP is intested in&#xA;&#xA;one taxonomycode may belongs to multiple category "
          ParentId="Package"
          FontInfo="{x:Null}"
          Size="575,200"
          Id="57b41202-6ef8-4fa8-8d8e-29b27255dcb5"
          TopLeft="284,318" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>